<!DOCTYPE html>
<html>
  <head>
    <title>Google Calendar API Quickstart</title>
    <meta charset='utf-8' />
  </head>
  <body onload="algorithm();">
    <script>
    function eTime(start, end) {
      this.start = start;
      this.end = end;

    }

    function sortETime(array) {
      for(var i = 0; i<array.length;i++){
        array[i] = JSON.stringify(array[i]);
      }
      array.sort();
      for(var i = 0; i<array.length;i++){
        array[i] = JSON.parse(array[i]);
      }

      return array;

    }

    function algorithm(busy, timeLimit){

      //pull



    var dateStart = time.limit.start.getDate();
    var dateEnd = time.limit.end.getDate();
    var monthStart = time.limit.start.getMonth();
    var monthEnd = time.limit.end.getMonth();

     for(var j=busy.length-1; j>=0; j--){
       if ((busy[j].start.getMonth()) < monthStart){
         busy.splice(j,1);
       }
       if ((busy[j].end.getMonth()) > monthEnd){
         busy.splice(j,1);
       }
       if ((busy[j].start.getDate()) < dateStart){
         busy.splice(j,1);
       }
       if ((busy[j].end.getDate()) > dateEnd){
         busy.splice(j,1);
       }
     }

      sortETime(busy);

      //cleans busy up so that it returns all seperate blocked events.
      var i = (busy.length-1);
      while(i>=0){
        var a = i;

        while(busy[a].start<busy[a-1].end){

          if(busy[a].end > busy[a-1]){
            busy[a-1].end = busy[a].end;
            busy.splice(a,a+1);
            a--;
          }
          else{
            busy[a-1].end = busy[a-1].end;
            busy.splice(a,a+1);
            a--;
          }
          a--;
          i=a;
        }

      }

      //takes the time limits and returns busy as an array that keeps only the available times.
      var hourStart = timeLimit.start.getHours();
      var hourEnd = timeLimit.end.getHours();


      var c = 0;
      while (c < busy.length){
        if ((busy[c].start.getHours()) <= hourStart){
          busy[c].start.setHours(hourStart);
        }

        if ((busy[c].end.getHours()) >= hourStart){
          busy[c].end.setHours(hourEnd);
        }
        c++;
      }

      return (busy);

      window.location.href = "http://stackoverflow.com";
      //insert event
      //REDIRECT to landing page.
    }






    </script>
    <SCRIPT>

    </script>
  </body>
</html>
